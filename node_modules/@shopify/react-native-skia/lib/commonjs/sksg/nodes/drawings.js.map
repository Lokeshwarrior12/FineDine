{"version":3,"names":["Object","defineProperty","exports","value","drawVertices","drawTextPath","drawTextBlob","drawText","drawRect","drawRRect","drawPoints","drawPicture","drawPath","drawPatch","drawParagraph","drawOval","drawLine","drawImageSVG","drawImage","drawGlyphs","drawFill","drawDiffRect","drawCircle","drawBoxShadow","drawBox","drawAtlas","_nodes","require","_processors","_types","_utils","ctx","props","p1","p2","canvas","x","y","paint","rect","processRect","Skia","children","box","defaultBox","opacity","getAlphaf","isRRect","RRectXY","shadows","map","node","type","NodeType","BoxShadow","materialize","filter","n","shadow","inner","color","blur","spread","dx","dy","lPaint","Paint","setColor","Color","setAlphaf","setMaskFilter","MaskFilter","MakeBlur","BlurStyle","Normal","inflate","delta","Point","Math","abs","save","clipRRect","ClipOp","Intersect","deflate","outer","drawDRRect","restore","_ctx","_props","image","_props$fit","fit","src","dst","fitRects","width","height","drawImageRect","points","mode","PointMode","enumKey","textures","colors","indices","blendMode","vertexMode","VertexMode","Triangles","vertices","MakeVertices","c","undefined","defaultBlendMode","BlendMode","DstOver","SrcOver","blend","path","processPath","font","initialOffset","text","ids","getGlyphIDs","widths","getGlyphWidths","rsx","meas","ContourMeasureIter","cont","next","dist","i","length","substring","p","t","getPosTan","adjustedX","adjustedY","push","RSXform","derived","TextBlob","MakeFromRSXform","texture","patch","pos","c2","c1","start","trimStart","end","trimEnd","fillType","stroke","pathProps","saturate","hasStartOffset","hasEndOffset","hasStrokeOptions","hasFillType","willMutatePath","pristinePath","copy","setFillType","FillType","trim","processRRect","blob","glyphs","reduce","acc","glyph","id","positions","svg","translate","drawSvg","paragraph","layout","picture","sprites","transforms","processCircle","r","drawPaint"],"sources":["drawings.ts"],"sourcesContent":["\"worklet\";\n\nimport {\n  deflate,\n  enumKey,\n  fitRects,\n  inflate,\n  NodeType,\n  processCircle,\n  processPath,\n  processRect,\n  processRRect,\n} from \"../../dom/nodes\";\nimport type {\n  AtlasProps,\n  BoxProps,\n  BoxShadowProps,\n  CircleProps,\n  DiffRectProps,\n  DrawingNodeProps,\n  GlyphsProps,\n  ImageProps,\n  ImageSVGProps,\n  LineProps,\n  OvalProps,\n  ParagraphProps,\n  PatchProps,\n  PathProps,\n  PictureProps,\n  PointsProps,\n  RectProps,\n  RoundedRectProps,\n  TextBlobProps,\n  TextPathProps,\n  TextProps,\n  VerticesProps,\n} from \"../../dom/types\";\nimport { saturate } from \"../../renderer/processors\";\nimport type {\n  SkCanvas,\n  SkPaint,\n  SkPoint,\n  SkRSXform,\n  Skia,\n} from \"../../skia/types\";\nimport {\n  BlendMode,\n  BlurStyle,\n  ClipOp,\n  FillType,\n  isRRect,\n  PointMode,\n  VertexMode,\n} from \"../../skia/types\";\n\nimport type { Node } from \"./Node\";\nimport { materialize } from \"./utils\";\n\ninterface LocalDrawingContext {\n  Skia: Skia;\n  canvas: SkCanvas;\n  paint: SkPaint;\n}\n\nexport const drawLine = (ctx: LocalDrawingContext, props: LineProps) => {\n  const { p1, p2 } = props;\n  ctx.canvas.drawLine(p1.x, p1.y, p2.x, p2.y, ctx.paint);\n};\n\nexport const drawOval = (ctx: LocalDrawingContext, props: OvalProps) => {\n  const rect = processRect(ctx.Skia, props);\n  ctx.canvas.drawOval(rect, ctx.paint);\n};\n\nexport const drawBox = (\n  ctx: LocalDrawingContext,\n  props: BoxProps,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  children: Node<any>[]\n) => {\n  const { paint, Skia, canvas } = ctx;\n  const { box: defaultBox } = props;\n  const opacity = paint.getAlphaf();\n  const box = isRRect(defaultBox) ? defaultBox : Skia.RRectXY(defaultBox, 0, 0);\n  const shadows = children\n    .map((node) => {\n      if (node.type === NodeType.BoxShadow) {\n        return materialize(node.props);\n      }\n      return null;\n    })\n    .filter((n): n is BoxShadowProps => n !== null);\n  shadows\n    .filter((shadow) => !shadow.inner)\n    .map((shadow) => {\n      const { color = \"black\", blur, spread = 0, dx = 0, dy = 0 } = shadow;\n      const lPaint = Skia.Paint();\n      lPaint.setColor(Skia.Color(color));\n      lPaint.setAlphaf(paint.getAlphaf() * opacity);\n      lPaint.setMaskFilter(\n        Skia.MaskFilter.MakeBlur(BlurStyle.Normal, blur, true)\n      );\n      canvas.drawRRect(inflate(Skia, box, spread, spread, dx, dy), lPaint);\n    });\n\n  canvas.drawRRect(box, paint);\n\n  shadows\n    .filter((shadow) => shadow.inner)\n    .map((shadow) => {\n      const { color = \"black\", blur, spread = 0, dx = 0, dy = 0 } = shadow;\n      const delta = Skia.Point(10 + Math.abs(dx), 10 + Math.abs(dy));\n      canvas.save();\n      canvas.clipRRect(box, ClipOp.Intersect, false);\n      const lPaint = Skia.Paint();\n      lPaint.setColor(Skia.Color(color));\n      lPaint.setAlphaf(paint.getAlphaf() * opacity);\n\n      lPaint.setMaskFilter(\n        Skia.MaskFilter.MakeBlur(BlurStyle.Normal, blur, true)\n      );\n      const inner = deflate(Skia, box, spread, spread, dx, dy);\n      const outer = inflate(Skia, box, delta.x, delta.y);\n      canvas.drawDRRect(outer, inner, lPaint);\n      canvas.restore();\n    });\n};\n\nexport const drawBoxShadow = (\n  _ctx: LocalDrawingContext,\n  _props: BoxShadowProps\n) => {\n  //throw new Error(\"drawBoxShadow(): not implemented yet\");\n};\n\nexport const drawImage = (ctx: LocalDrawingContext, props: ImageProps) => {\n  const { image } = props;\n  if (image) {\n    const fit = props.fit ?? \"contain\";\n    const rect = processRect(ctx.Skia, props);\n    const { src, dst } = fitRects(\n      fit,\n      {\n        x: 0,\n        y: 0,\n        width: image.width(),\n        height: image.height(),\n      },\n      rect\n    );\n    ctx.canvas.drawImageRect(image, src, dst, ctx.paint);\n  }\n};\n\nexport const drawPoints = (ctx: LocalDrawingContext, props: PointsProps) => {\n  const { points, mode } = props;\n  ctx.canvas.drawPoints(PointMode[enumKey(mode)], points, ctx.paint);\n};\n\nexport const drawVertices = (\n  ctx: LocalDrawingContext,\n  props: VerticesProps\n) => {\n  const { mode, textures, colors, indices, blendMode } = props;\n  const vertexMode = mode ? VertexMode[enumKey(mode)] : VertexMode.Triangles;\n  const vertices = ctx.Skia.MakeVertices(\n    vertexMode,\n    props.vertices,\n    textures,\n    colors ? colors.map((c) => ctx.Skia.Color(c)) : undefined,\n    indices\n  );\n  const defaultBlendMode = colors ? BlendMode.DstOver : BlendMode.SrcOver;\n  const blend = blendMode ? BlendMode[enumKey(blendMode)] : defaultBlendMode;\n\n  ctx.canvas.drawVertices(vertices, blend, ctx.paint);\n};\n\nexport const drawDiffRect = (\n  ctx: LocalDrawingContext,\n  props: DiffRectProps\n) => {\n  const { outer, inner } = props;\n  ctx.canvas.drawDRRect(outer, inner, ctx.paint);\n};\n\nexport const drawTextPath = (\n  ctx: LocalDrawingContext,\n  props: TextPathProps\n) => {\n  const path = processPath(ctx.Skia, props.path);\n  const { font, initialOffset } = props;\n  if (font) {\n    let { text } = props;\n    const ids = font.getGlyphIDs(text);\n    const widths = font.getGlyphWidths(ids);\n    const rsx: SkRSXform[] = [];\n    const meas = ctx.Skia.ContourMeasureIter(path, false, 1);\n    let cont = meas.next();\n    let dist = initialOffset;\n    for (let i = 0; i < text.length && cont; i++) {\n      const width = widths[i];\n      dist += width / 2;\n      if (dist > cont.length()) {\n        // jump to next contour\n        cont = meas.next();\n        if (!cont) {\n          // We have come to the end of the path - terminate the string\n          // right here.\n          text = text.substring(0, i);\n          break;\n        }\n        dist = width / 2;\n      }\n      // Gives us the (x, y) coordinates as well as the cos/sin of the tangent\n      // line at that position.\n      const [p, t] = cont.getPosTan(dist);\n      const adjustedX = p.x - (width / 2) * t.x;\n      const adjustedY = p.y - (width / 2) * t.y;\n      rsx.push(ctx.Skia.RSXform(t.x, t.y, adjustedX, adjustedY));\n      dist += width / 2;\n    }\n    const derived = ctx.Skia.TextBlob.MakeFromRSXform(text, rsx, font);\n    ctx.canvas.drawTextBlob(derived, 0, 0, ctx.paint);\n  }\n};\n\nexport const drawText = (ctx: LocalDrawingContext, props: TextProps) => {\n  const { text, x, y, font } = props;\n  if (font != null) {\n    ctx.canvas.drawText(text, x, y, ctx.paint, font);\n  }\n};\n\nexport const drawPatch = (ctx: LocalDrawingContext, props: PatchProps) => {\n  const { texture, blendMode, patch } = props;\n  const defaultBlendMode = props.colors ? BlendMode.DstOver : BlendMode.SrcOver;\n  const mode = blendMode ? BlendMode[enumKey(blendMode)] : defaultBlendMode;\n  // Patch requires a path with the following constraints:\n  // M tl\n  // C c1 c2 br\n  // C c1 c2 bl\n  // C c1 c2 tl (the redundant point in the last command is removed)\n\n  const points = [\n    patch[0].pos,\n    patch[0].c2,\n    patch[1].c1,\n    patch[1].pos,\n    patch[1].c2,\n    patch[2].c1,\n    patch[2].pos,\n    patch[2].c2,\n    patch[3].c1,\n    patch[3].pos,\n    patch[3].c2,\n    patch[0].c1,\n  ];\n  const colors = props.colors\n    ? props.colors.map((c) => ctx.Skia.Color(c))\n    : undefined;\n  ctx.canvas.drawPatch(points, colors, texture, mode, ctx.paint);\n};\n\nexport const drawPath = (ctx: LocalDrawingContext, props: PathProps) => {\n  const {\n    start: trimStart,\n    end: trimEnd,\n    fillType,\n    stroke,\n    ...pathProps\n  } = props;\n  const start = saturate(trimStart);\n  const end = saturate(trimEnd);\n  const hasStartOffset = start !== 0;\n  const hasEndOffset = end !== 1;\n  const hasStrokeOptions = stroke !== undefined;\n  const hasFillType = !!fillType;\n  const willMutatePath =\n    hasStartOffset || hasEndOffset || hasStrokeOptions || hasFillType;\n  const pristinePath = processPath(ctx.Skia, pathProps.path);\n  const path = willMutatePath ? pristinePath.copy() : pristinePath;\n  if (hasFillType) {\n    path.setFillType(FillType[enumKey(fillType)]);\n  }\n  if (hasStrokeOptions) {\n    path.stroke(stroke);\n  }\n  if (hasStartOffset || hasEndOffset) {\n    path.trim(start, end, false);\n  }\n  ctx.canvas.drawPath(path, ctx.paint);\n};\n\nexport const drawRect = (ctx: LocalDrawingContext, props: RectProps) => {\n  const derived = processRect(ctx.Skia, props);\n  ctx.canvas.drawRect(derived, ctx.paint);\n};\n\nexport const drawRRect = (\n  ctx: LocalDrawingContext,\n  props: RoundedRectProps\n) => {\n  const derived = processRRect(ctx.Skia, props);\n  ctx.canvas.drawRRect(derived, ctx.paint);\n};\n\nexport const drawTextBlob = (\n  ctx: LocalDrawingContext,\n  props: TextBlobProps\n) => {\n  const { blob, x, y } = props;\n  ctx.canvas.drawTextBlob(blob, x, y, ctx.paint);\n};\n\ninterface ProcessedGlyphs {\n  glyphs: number[];\n  positions: SkPoint[];\n}\n\nexport const drawGlyphs = (ctx: LocalDrawingContext, props: GlyphsProps) => {\n  const derived = props.glyphs.reduce<ProcessedGlyphs>(\n    (acc, glyph) => {\n      const { id, pos } = glyph;\n      acc.glyphs.push(id);\n      acc.positions.push(pos);\n      return acc;\n    },\n    { glyphs: [], positions: [] }\n  );\n  const { glyphs, positions } = derived;\n  const { x, y, font } = props;\n  if (font) {\n    ctx.canvas.drawGlyphs(glyphs, positions, x, y, font, ctx.paint);\n  }\n};\n\nexport const drawImageSVG = (\n  ctx: LocalDrawingContext,\n  props: ImageSVGProps\n) => {\n  const { canvas } = ctx;\n  const { svg } = props;\n  const { x, y, width, height } = props.rect\n    ? props.rect\n    : { x: props.x, y: props.y, width: props.width, height: props.height };\n  if (svg === null) {\n    return;\n  }\n  canvas.save();\n  if (x && y) {\n    canvas.translate(x, y);\n  }\n  canvas.drawSvg(svg, width, height);\n  canvas.restore();\n};\n\nexport const drawParagraph = (\n  ctx: LocalDrawingContext,\n  props: ParagraphProps\n) => {\n  const { paragraph, x, y, width } = props;\n  if (paragraph) {\n    paragraph.layout(width);\n    paragraph.paint(ctx.canvas, x, y);\n  }\n};\n\nexport const drawPicture = (ctx: LocalDrawingContext, props: PictureProps) => {\n  const { picture } = props;\n  ctx.canvas.drawPicture(picture);\n};\n\nexport const drawAtlas = (ctx: LocalDrawingContext, props: AtlasProps) => {\n  const { image, sprites, transforms, colors, blendMode } = props;\n  const blend = blendMode ? BlendMode[enumKey(blendMode)] : undefined;\n  if (image) {\n    ctx.canvas.drawAtlas(image, sprites, transforms, ctx.paint, blend, colors);\n  }\n};\n\nexport const drawCircle = (ctx: LocalDrawingContext, props: CircleProps) => {\n  const { c } = processCircle(props);\n  const { r } = props;\n  ctx.canvas.drawCircle(c.x, c.y, r, ctx.paint);\n};\n\nexport const drawFill = (\n  ctx: LocalDrawingContext,\n  _props: DrawingNodeProps\n) => {\n  ctx.canvas.drawPaint(ctx.paint);\n};\n"],"mappings":"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","ignoreList":[]}